<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<div class="akairo-calculator-wrapper">
  <div class="calculator-header">
    <h2>Simulateur de Rentabilit√© & ROI</h2>
  </div>

  <div class="calculator-form">
    
    <h4 style="margin: 0 0 16px 0; font-size: 18px; color: #333;">1. Donn√©es du point de vente</h4>
    
    <div class="input-group-row">
      <div class="form-group main-input">
        <label for="trafic">Trafic mensuel actuel</label>
        <input type="number" id="trafic" name="trafic" value="1000" placeholder="Ex: 1000" min="0">
        <span class="helper-text">Nombre de personnes qui entrent dans votre point de vente</span>
      </div>

      <div class="form-group secondary-input">
        <label for="taux_hausse_trafic" class="label-simulation">
          <span class="icon-sim">‚ö°</span> Simulation
        </label>
        <div class="input-suffix-wrapper">
          <input type="number" id="taux_hausse_trafic" value="33">
          <span class="suffix">%</span>
        </div>
        <span class="helper-text">Hausse estim√©e</span>
      </div>
    </div>

    <div class="form-group">
      <label for="ventes">Nombre de ventes mensuelles</label>
      <input type="number" id="ventes" name="ventes" value="100" placeholder="Ex: 100">
      <span class="helper-text">Nombre de transactions r√©alis√©es par mois</span>
    </div>

    <div class="form-group">
      <label for="panier">Panier moyen actuel (‚Ç¨)</label>
      <input type="number" id="panier" name="panier" value="50" placeholder="Ex: 50">
      <span class="helper-text">Montant moyen d√©pens√© par client</span>
    </div>

    <hr style="margin: 32px 0; border: 0; border-top: 1px solid #e0e0e0;">

    <div class="finance-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
      <h4 style="margin: 0; font-size: 18px; color: #333;">2. Offre & Financement</h4>
      
      <div class="toggle-container">
        <input type="radio" id="mode_achat" name="financement" value="achat" checked onchange="toggleFinancement()">
        <label for="mode_achat">Achat Comptant</label>
        
        <input type="radio" id="mode_location" name="financement" value="location" onchange="toggleFinancement()">
        <label for="mode_location">Location RSE</label>
        
        <div class="toggle-slider"></div>
      </div>
    </div>

    <div class="finance-inputs">
      <div class="form-group">
        <label id="label_invest" for="investissement">Investissement initial (‚Ç¨)</label>
        <input type="number" id="investissement" name="investissement" value="3500">
        <span id="helper_invest" class="helper-text">Mat√©riel + Installation + Logiciel</span>
      </div>

      <div class="input-group-row">
        <div class="form-group main-input" id="group_loyer" style="display: none;">
          <label for="loyer_mensuel" style="color: #DE0B19;">Loyer Mensuel RSE (‚Ç¨)</label>
          <input type="number" id="loyer_mensuel" value="145" style="border-color: #DE0B19;">
          <span class="helper-text">Mat√©riel + Services inclus</span>
        </div>

        <div class="form-group main-input">
          <label id="label_couts" for="couts_mensuels">Co√ªts mensuels r√©currents (‚Ç¨)</label>
          <input type="number" id="couts_mensuels" name="couts_mensuels" value="100">
          <span id="helper_couts" class="helper-text">Abonnement IDPLAY + Maintenance</span>
        </div>
      </div>
    </div>

    <button type="button" class="btn-calculate">G√©n√©rer l'analyse financi√®re</button>
  </div>

  <div class="calculator-results" id="results" style="display: none;">
    <div class="results-header">
      <h3>Analyse de Performance</h3>
      <p class="results-subtitle">Les prix indiqu√©s sont Hors Taxe (HT)</p>
    </div>

    <div class="results-grid">
      <div class="result-card situation-avant">
        <h4>Actuellement</h4>
        <div class="metric"><span class="metric-label">Trafic</span><span class="metric-value" id="trafic_avant">-</span></div>
        <div class="metric"><span class="metric-label">Ventes</span><span class="metric-value" id="ventes_avant">-</span></div>
        <div class="metric"><span class="metric-label">Panier</span><span class="metric-value" id="panier_avant">-</span></div>
        <div class="metric highlight"><span class="metric-label">CA Mensuel</span><span class="metric-value" id="ca_avant">-</span></div>
      </div>

      <div class="result-card situation-apres">
        <h4>Projection AKAIRO</h4>
        <div class="metric">
          <span class="metric-label">Trafic</span>
          <span class="metric-badge" id="badge_trafic">+33%</span>
          <span class="metric-value positive" id="trafic_apres">-</span>
        </div>
        <div class="metric">
          <span class="metric-label">Ventes</span>
          <span class="metric-badge" id="badge_ventes">+33%</span>
          <span class="metric-value positive" id="ventes_apres">-</span>
        </div>
        <div class="metric">
          <span class="metric-label">Panier</span>
          <span class="metric-badge">+29,5%</span>
          <span class="metric-value positive" id="panier_apres">-</span>
        </div>
        <div class="metric highlight">
          <span class="metric-label">CA Mensuel</span>
          <span class="metric-badge" id="badge_ca">+72,2%</span>
          <span class="metric-value positive" id="ca_apres">-</span>
        </div>
      </div>
    </div>

    <div class="gain-mensuel">
      <div class="gain-label">Gain mensuel de chiffre d'affaires</div>
      <div class="gain-value" id="gain_mensuel">-</div>
      <div class="gain-annuel">Soit <strong id="gain_annuel">-</strong> de CA additionnel esp√©r√©/ an</div>
    </div>

    <div class="treso-section" id="bloc_tresorerie" style="display: none;">
      <div class="treso-label">Tr√©sorerie Nette Mensuelle</div>
      <div class="treso-value" id="tresorerie_nette">-</div>
      <div class="treso-sub">Cash-flow g√©n√©r√© une fois l'√©cran et les services pay√©s.</div>
    </div>

    <div class="pdf-action-container" style="text-align: center; margin-bottom: 32px;" data-html2canvas-ignore="true">
        <button type="button" class="btn-calculate btn-download-pdf" style="background-color: #333; width: auto; padding: 12px 24px; margin-top: 0;">
            üìÑ T√©l√©charger le rapport PDF
        </button>
    </div>

    <div class="roi-section">
      <h4>Performance financi√®re (Ann√©e 1)</h4>
      <div class="roi-grid">
        <div class="roi-card">
          <span class="roi-label">Investissement</span>
          <span class="roi-value" style="color: #1A1A1A;" id="res_invest">-</span>
        </div>
        <div class="roi-card">
          <span class="roi-label">Chiffre d'Affaires</span>
          <span class="roi-value" id="res_ca_1an">-</span>
        </div>
        <div class="roi-card highlight-card">
          <span class="roi-label">ROI</span>
          <span class="roi-value" id="res_benefice">-</span>
        </div>
        <div class="roi-card">
          <span class="roi-label">Dur√©e d'amortissement</span>
          <span class="roi-value" id="res_amortissement">-</span>
        </div>
      </div>
      <div class="roi-disclaimer">
    <p>* Le ROI et la dur√©e d'amortissement sont calcul√©s sur la base de l'investissement initial (mat√©riel + installation). Les gains pr√©sent√©s correspondent au chiffre d'affaires additionnel g√©n√©r√©.</p>
  </div>
    </div>

    <div class="chart-section" style="background: #FFF; padding: 24px; border-radius: 8px; border: 1px solid #E0E0E0; margin-bottom: 24px;">
      <h4 style="text-align: center; margin-bottom: 20px; color: #333; font-size: 16px;">Zone de Profit (Projection Cumul√©e sur 3 ans)</h4>
      <div class="chart-container" style="position: relative; height: 300px; width: 100%;">
        <canvas id="roiChart"></canvas>
      </div>
    </div>

    <div class="inaction-section">
      <div class="inaction-text">
        <h4>Le co√ªt de l'attente</h4>
        <p>Si vous attendez <strong>6 mois</strong> avant de vous √©quiper, vous passez √† c√¥t√© de <span id="cout_inaction" class="inaction-amount">-</span> de chiffre d'affaires potentiel.</p>
      </div>
    </div>

    <div id="pdf-footer" style="display: none; text-align: center; margin-top: 30px; border-top: 2px solid #DE0B19; padding-top: 20px;">
        <p style="font-size: 14px; color: #333; margin-bottom: 5px;"><strong>AKAIRO - Solutions d'affichage dynamique</strong></p>
        <p style="font-size: 12px; color: #666; margin: 0;">
            Retrouvez nos solutions sur <span style="color: #DE0B19;">www.akairo.fr</span><br>
            Ceci est une simulation indicative bas√©e sur des moyennes observ√©es.
        </p>
    </div>

    <div class="sources-footer">
      <p>Sources : Estimations bas√©es sur les moyennes constat√©es par nos clients et √©tudes du secteur Digital Signage (2024).</p>
      <p>Les r√©sultats sont des simulations √† titre indicatif et ne constituent pas un engagement contractuel.</p>
    </div>

  </div>
  
  <input type="hidden" name="trafic_visiteurs_mensuel">
  <input type="hidden" name="gain_mensuel_estime">
  <input type="hidden" name="roi_previsionnel_12_mois">
  <input type="hidden" name="budget_investissement_estime">
</div>
